@startuml EIA Community Feedback Data Structure

!define PRIMARY_COLOR #15803d
!define SECONDARY_COLOR #22c55e
!define ACCENT_COLOR #16a34a

skinparam class {
    BackgroundColor white
    BorderColor PRIMARY_COLOR
    ArrowColor PRIMARY_COLOR
    FontSize 10
}

skinparam enum {
    BackgroundColor #f0fdf4
    BorderColor ACCENT_COLOR
}

package "Core Entities" {
    class Project {
        +string id
        +string name
        +string description
        +string category {A|B}
        +ProjectStatus status
        +string developer
        +string? consultant
        +Date commentPeriodStart
        +Date commentPeriodEnd
        +Date createdAt
        +Date updatedAt
        +number? commentCount
        +number? resolvedCommentCount
    }

    class Comment {
        +string id
        +string projectId
        +string content
        +CommentType commentType
        +EnvironmentalCategory environmentalCategory
        +string stakeholderId
        +string stakeholderName
        +StakeholderType stakeholderType
        +CommentStatus status
        +string? assignedTo
        +Priority priority
        +Date createdAt
        +Date updatedAt
        +string? response
        +Date? responseDate
        +ResponseAuthor? responseAuthor
        +boolean? isDuplicate
        +string? duplicateOf
        +string[]? relatedCommentIds
        +string[]? tags
        +Source source
        +string[]? mitigationStrategyIds
        +boolean? flaggedForPublicMeeting
        +Date? publicMeetingDate
    }

    class Stakeholder {
        +string id
        +string name
        +StakeholderType type
        +string? email
        +string? organization
        +boolean isMandatory
        +Date? submissionDeadline
        +boolean? hasSubmitted
        +Date? submissionDate
        +number? historicalCommentCount
    }
}

package "Response & Mitigation" {
    class ResponseAuthor {
        +string name
        +string role
        +string? organization
        +string? email
    }

    class MitigationStrategy {
        +string id
        +string projectId
        +string title
        +string description
        +EnvironmentalCategory environmentalCategory
        +StrategyStatus status
        +string? effectiveness
        +string[]? relatedCommentIds
        +Date createdAt
        +Date updatedAt
    }
}

package "Timeline & Meetings" {
    class TimelineEvent {
        +string id
        +string projectId
        +string title
        +string description
        +EventType type
        +Date date
        +EventStatus status
        +boolean isPublic
        +string[]? relatedCommentIds
        +string? location
        +string[]? attendees
    }

    class PublicMeeting {
        +string id
        +string projectId
        +string title
        +string description
        +Date date
        +string location
        +MeetingFormat format
        +string? meetingUrl
        +string[]? agenda
        +string[]? relatedCommentIds
        +string[]? attendees
        +string? notes
    }
}

package "Derived/Computed" {
    class CommentGroup {
        +EnvironmentalCategory category
        +Comment[] comments
        +MitigationStrategy[] mitigationStrategies
    }

    class CommentPeriod {
        +string projectId
        +Date startDate
        +Date endDate
        +number durationWeeks
        +string[] mandatoryCommenters
        +Date[] remindersSent
    }

    class Metrics {
        +number totalComments
        +Record commentsByStatus
        +Record commentsByCategory
        +Record commentsByType
        +number averageResponseTime
        +number responseCompleteness
        +number pendingMandatorySubmissions
    }
}

package "Enumerations" {
    enum CommentType {
        technical
        procedural
        substantive
        out-of-scope
    }

    enum EnvironmentalCategory {
        birds
        water
        visual-impact
        archaeological
        vegetation
        noise
        traffic
        other
    }

    enum StakeholderType {
        public
        mandatory-agency
        special-interest-group
        municipality
        developer
    }

    enum CommentStatus {
        pending-review
        assigned
        draft-response
        final
        resolved
    }

    enum ProjectStatus {
        scoping
        assessment
        public-comment
        review
        approved
        rejected
    }

    enum Priority {
        low
        medium
        high
        critical
    }

    enum Source {
        skipulagsgÃ¡tt
        email
        manual
        postal
    }

    enum StrategyStatus {
        proposed
        approved
        implemented
        monitoring
    }

    enum EventType {
        milestone
        deadline
        meeting
        submission
        decision
        other
    }

    enum EventStatus {
        upcoming
        in-progress
        completed
        overdue
    }

    enum MeetingFormat {
        in-person
        virtual
        hybrid
    }
}

' Relationships - Core
Project "1" ||--o{ Comment : "has"
Project "1" ||--o{ MitigationStrategy : "has"
Project "1" ||--o{ TimelineEvent : "has"
Project "1" ||--o{ PublicMeeting : "has"
Project "1" ||--|| CommentPeriod : "has"
Project "1" ||--|| Metrics : "generates"

Comment "N" }o--|| Project : "belongs to"
Comment "N" }o--|| Stakeholder : "submitted by"
Comment "N" }o--o| ResponseAuthor : "responded by"
Comment "N" }o--o{ MitigationStrategy : "linked to"
Comment "N" }o--o{ Comment : "related to"

Stakeholder "N" ||--o{ Comment : "submits"
Stakeholder "N" }o--o{ CommentPeriod : "mandatory for"

MitigationStrategy "N" }o--|| Project : "belongs to"
MitigationStrategy "N" }o--o{ Comment : "addresses"

TimelineEvent "N" }o--|| Project : "belongs to"
TimelineEvent "N" }o--o{ Comment : "references"

PublicMeeting "N" }o--|| Project : "belongs to"
PublicMeeting "N" }o--o{ Comment : "discusses"

CommentGroup "1" ||--o{ Comment : "groups"
CommentGroup "1" ||--o{ MitigationStrategy : "groups"

' Enumeration relationships
Comment --> CommentType
Comment --> EnvironmentalCategory
Comment --> StakeholderType
Comment --> CommentStatus
Comment --> Priority
Comment --> Source
Project --> ProjectStatus
MitigationStrategy --> EnvironmentalCategory
MitigationStrategy --> StrategyStatus
TimelineEvent --> EventType
TimelineEvent --> EventStatus
PublicMeeting --> MeetingFormat
Stakeholder --> StakeholderType

note right of Project
  **Central Entity**
  All other entities
  relate to Project
end note

note right of Comment
  **Core Feedback Entity**
  Links stakeholders,
  projects, and
  mitigation strategies
end note

note right of Metrics
  **Computed Entity**
  Calculated from
  Comments and
  Stakeholders
end note

@enduml

